> s

[^1-2.1-1]:一个数据只和一个程序绑定，共享性差
[^2-2-1]:$(d_1,d_2,\cdots,d_n)$指每一个取值的相互组合

[toc]

# 第一章 基础知识

## 1. 数据库系统概述

1. 数据：数据是数据库中存储的基本对象。

   定义：描述事务的符号记录称为数据。可以是数字、文字、图片、声音等。

2. 数据库：==是长期储存在计算机内、有组织的、可共享的大量数据的集合==。

   特点：具有永久存储，有组织和可共享三个特点。

3. 数据库管理系统(DBMS)：数据库管理系统职能主要包括一下几个方面：

   - ==数据定义==功能：数据定义语言，用户通过他可以方便对数据库种的数据对象进行定义。
   - 数据存储、组织和管理：组织即如何存放数据库较为高效、存储即存在计算机哪个位置、管理即对数据进行管理。
   - ==数据操纵==功能：用户可以使用数据操纵语言操作数据，实现对数据的基本操作，如：增删改查等。
   - 数据库事务管理和运行管理：数据库在建立、运用和维护时由数据库管理系统统一管理、统一控制，以保证数据的安全性、完整性、多用户对数据的并发使用及发生故障后的系统恢复。
   - 数据建立和维护功能：数据库初始数据的输入、转换功能、数据库的转储、恢复功能以及数据库的重组织功能和性能监视、分析功能等。

4. 数据库系统(DBS)：数据库系统一般由数据库、数据库管理系统(及其开发工具)、应用系统、数据库管理员构成。

   [数据库系统结构：](https://image.sybblogs.fun/img-common/202309101627713.png)

   <img src="https://image.sybblogs.fun/img-common/202309101627713.png" alt="数据库系统结构" style="zoom:50%;" />

   以学生管理系统为例：`数据库管理员`利用`数据库管理系统`建立一个数据库(存放学生信息)，之后`教师(用户)`通过应用系统录入学生成绩，在之后`应用系统`会将学生成绩交给`数据库管理系统`，最后`数据库管理系统`再将学生成绩写入`数据库`。

   以上例子可以看出：应用系统和应用开发工具属于应用层面、数据管理系统和操作系统是数据库设计$/$管理层面、数据库是底层存储。

## 2. 数据管理技术产生与发展

数据库管理技术经理了人工管理、文件系统、数据库系统三个阶段。

### 2.1 人工管理阶段

阶段特点：数据不保存、应用程序管理数据、数据不共享、数据不具有独立性[^1-2.1-1]。

缺点：数据的逻辑结构或物理结构发生变化后，必须对应用程序做相对应的修改，加重了开发者负担。如：一个程序可以输入$1\sim100$，但逆序输入就需要重新开发对应程序。

### 2.2 文件系统管理阶段

阶段特点：数据可以长期保存、由文件系统管理数据。

缺点：数据共享性差，==冗余度==大、数据独立性差。

### 2.3 数据库阶段

特点：①数据结构化②数据的共享性高，冗余度低，易扩充③数据独立性高④数据由DBMS统一管理和控制

[数据库管理三个阶段比较：](https://image.sybblogs.fun/img-common/202309101654009.png)

<img src="https://image.sybblogs.fun/img-common/202309101654009.png" alt="数据库管理三个阶段比较" style="zoom: 33%;" />

## 3. 数据模型

数据模型是一种模型，是对现实世界数据特征的抽象。数据模型就是现实世界的模拟。

### 3.1 两类数据模型

数据模型分为两类：

（1）概念模型：也称信息模型，它是按用户观点来对数据和信息建模，主要用于数据库设计。

（2）逻辑模型和物理模型：分为两种主要用于数据库实现

- 逻辑模型：它是按计算机系统的观点对数据建模，主要用于DBMS实现。其主要包括层次模型(树)、网状模型(图)、关系模型(表，主流数据库模型)、面向对象模型和对象关系模型等。
- 物理模型：是对数据最底层的抽象，它描述数据在系统内部的表示方式和存取方法，在磁盘或磁带上的存储方式和存取方法。主要是面向计算机硬件系统的。

数据模型应满足三方面要求：

（1）能比较真实地模拟现实世界

（2）容易为人所理解(数据关系是标准网格状)

（3）便于在计算机上实现。

### 3.2 数据模型组成要素

数据模型通常由==数据结构==、==数据操作==和==完整性约束==三部分组成。以下给出解释：

1. 数据结构：数据结构描述数据库的组成对象以及对象之间的联系。数据结构是所描述的对象类型的集合，是对系统静态特性的描述。

2. 数据操作：数据库主要有查询和更新(包括插入、删除、修改)两大类操作。数据操作是对系统动态特性的描述。

3. 完整性约束：数据的完整性约束条件是一组完整性规则。

   例1：在关系型中，任何关系必须满足实体完整性(每个数据都应该有一个能确认一条信息的关键字)和参照完整性(同一个信息在多张表内要一致)两个条件。

   例2：在某大学的数据库中规定教授的退休年龄是`65周岁`；男职工退休年龄是`60周岁`，女职工退休年龄是`55周岁`等。

### 3.3 概念模型

概念模型是现实世界到机器世界的一个中间层次，可以将现实世界数据转换为计算机可认识的数据库，并放在硬盘中，起到承上启下作用。表现为：

（1）概念模型用于信息世界的建模

（2）现实世界到信息世界的第一 层抽象

（3）数据库设计人员进行数据库设计的有力工具(用表、树，图等结构进行设计)

（4）数据库设计人员和用户之间进行交流的语言(是否符合实际用户层面需求)

[概念模型：]()

<img src="https://image.sybblogs.fun/img-common/202309102207186.png" alt="概念模型" style="zoom:50%;" />

概念模型要求：①具有较强的语义表达能力。②能够方便、直接地表达应用中的各种语义知识。③简单、清晰、易于用户理解。

#### 信息世界中的基本概念

1. 实体(Entity)

   客观存在井可相互区别的事物称为实体。实体可以是具体的事、物，也可以是抽象的概念或联系。

   例：一个职工、一个学生、一个部门、一门课，学生的一次选课都是实体。

2. 属性(attribute)

   实体所具有的某一特性称为属性。一个实体可以由若干个属性来刻画。

   例：学生实体可以由学号、姓名、性别、出生年月等组成。

3. 码(key)

   唯一标识实体的属性集称为码

   例：学号是学生的码

4. 域(Domain)

   域是一组具有相同数据类型的值的集合。属性的取值范围来自某个域

   例：学号的域为8位整数，学生年龄的域为整数，性别的域为$男/女$

5. 实体型(Entity Type)

   具有相同属性的实体必然具有共同的特征和性质。用实体名及其属性名集合来抽象和刻画同类实体，称为实体型。

   例：学生(学号、姓名、性别，出生年月日等)就是一个实体型。

6. 实体集(Entity Set)

   同一类型实体的集合称为实体集

   例：全体学生就是一个实体集。

7. ==联系==(Relationship)

   在现实世界中，事物内部以及事物之间是有联系的，这些联系在信息世界中反映为实体(型)内部联系和实体(型)之间的联系。

   实体内部的联系通常是指组成实体的各属性之间的联系(班长与学生)；实体之间的联系通常是指不同实体集之间的联系(老师与学生)。

#### 两个实体型之间的联系

1. 一对一联系

   如果对于实体集$A$中的每一个实体，实体集$B$中至多有一个(也可以没有)实体与之联系，反之亦然，则称实体集$A$与实体集$B$具有一对一的联系，记作$1:1$

   例：学校里面，一个班级只有一个正班长，而一个班长只在一个班中任职，则班级与班长之间具有一对一联系。

   这里班级是实体集$A$，班长是实体集$B$，而`一个班级只有一个正班长`是一对一联系。

   [一对一联系：](https://image.sybblogs.fun/img-common/202309112219507.png)

   <img src="https://image.sybblogs.fun/img-common/202309112219507.png" alt="一对一联系" style="zoom:43%;" />

2. 一对多联系($1:n$)

   如果对于实体集$A$中的每一个实体，实体集$B$中有$n$个实体($n\ge0$)与之联系，反之，对于实体集$B$中的每一个实体，实体集$A$中至多有一个实体与之联系，则称实体集$A$与实体集$B$有一对多联系，记作$1:n$。

   例：一个班级中有若干名学生，而每个学生只在一个班级中学习，则班级与学生之间具有一对多联系。

   [一对多关系：]()

   <img src="https://image.sybblogs.fun/img-common/202309112232990.png" alt="一对多关系" style="zoom:43%;" />

3. 多对多联系($m:n$)

   如果对于实体集$A$中的每一个实体，实体集$B$中有$n$个实体($n\ge0$)与之联系，反之，对于实体集$B$中的每一个实体，实体集$A$中也有$m$个实体($m\ge0$)与之联系，则称实体集$A$与实体集$B$具有多对多联系，记作$m:n$。

   例：课程和学生之间关系

   [多对多联系：]()

   <img src="https://image.sybblogs.fun/img-common/202309112238803.png" alt="多对多联系" style="zoom:43%;" />

#### 两个以上的实体型之间的联系

两个以上的实体型之间也存在着一对一、一对多、多对多联系。

若实体型$E_1,E_2,\cdots,E_n$之间存在联系，对于实体型$E_i(j=1,2,\cdots,i-1,i+1,\cdots,n)$中的给定实体，最多只和$E_i$中的一个实体相联系，则说$E_i$与$E_1,E_2,\cdots,E_i-1,E_i+1,\cdots,E_n$之间能联系是一对多的。

例1：对于课程、教师与参考书$3$个实体型，如果一门课程可以有若干个教师授课，使用若干本参考书，而每一个教师只讲授一门课程，每一本参考书只供一门课程使用，则课程与教师、参考书之间的联系是一对多的。

[实体型之间的一对多：](https://image.sybblogs.fun/img-common/202309112306450.png)

<img src="https://image.sybblogs.fun/img-common/202309112306450.png" alt="实体型之间的一对多" style="zoom:43%;" />

例2：有3个实体型：供应商、项目、零件，一个供应商可以供给多个项目多种零件，而每个项目可以使用多个供应商供应的零件，每种零件可由不同供应商供给，由此可以看出供应商、项目、零件三者之间是多对多的联系。

[实体型之间的多对多：](https://image.sybblogs.fun/img-common/202309112312177.png)

<img src="https://image.sybblogs.fun/img-common/202309112312177.png" alt="实体型之间的多对多" style="zoom:43%;" />

#### 单个实体型内的联系

同一个实体集内的各实体之间也可以存在一对一、一对多、 多对多的联系。

例：职工实体型内部具有领导与被领导的联系，即某一职工领导若干名职工，而一个职工仅被一个职工直接领导，因此这是一对多关系。

[单个实体型一对多联系：](https://image.sybblogs.fun/img-common/202309112316796.png)

<img src="https://image.sybblogs.fun/img-common/202309112316796.png" alt="单个实体型一对多联系" style="zoom:43%;" />

#### 概念模型的一种表示方法：实体-联系图(E-R图)

E-R图提供了表示实体型、属性和联系的方法。

实体型：用矩形表示，矩形框内联系的方法

属性：用椭圆表示，并用无向边将其与相应的实体型连接起来。

联系：用菱形表示，菱形框内写明联系名，并用无向边分别与有关实体型连接起来，同时在无向边旁标上联系的类型($1:1,1:n,n:m$)

注意：如果一个联系具有属性，则这些属性也要用无向边与该联系连接起来。

例：如果用`供应量`来描述联系`供应`的属性，表示某供应商供应了多少数量的零件给某个项目。那么这3个实体及其之间的联系E-R图如下.

[供应商与供应量的E-R图：](https://image.sybblogs.fun/img-common/202309121433635.png)

<img src="https://image.sybblogs.fun/img-common/202309121433635.png" alt="供应商与供应量的E-R图" style="zoom:43%;" />

| 实体型 | 属性 | 联系 |
| :----: | :--: | :--: |
|  矩形  | 椭圆 | 菱形 |

#### 实例

用E-R图表示某个工厂物资管理的概念模型。物资管理涉及的实体有：

①仓库属性有仓库号、面积、电话号码

②零件的属性有零件号、名称、规格、单价、描述

③供应商属性有供应商号、姓名、地址、电话号码、账号

④项目的属性有项目号、预算、开工日期

⑤职工属性有职工号、姓名、年龄、职称

> 实体之间的联系如下：
>
> (1)一个仓库可以存放多种零件，一种零件可以存放在多个仓库中，因此`仓库和零件具有多对多`的联系。用库存量来表示某种零件在某个仓库中的数量。
>
> (2)仓库和职工之间是一对多关系
>
> (3)职工实体集中具有一对多关系
>
> (4)供应商、项目和零件三者之间具有多对多关系

[实体间联系E-R图：](https://image.sybblogs.fun/img-common/202309121504210.png)

<img src="https://image.sybblogs.fun/img-common/202309121504210.png" alt="实例答案" style="zoom:43%;" />

### 3.4 逻辑数据模型

数据库中最常用的逻辑数据模型有：层次模型(树结构)、网状模型(图)、==关系模型==(表格，主流数据库模型)、面向对象模型和对象关系模型

#### 关系数据模型的数据结构

关系：一个关系对应通常说的==一张表==

元组：表中的`一行`即为一个元组

属性：表中的`一列`即为一个属性，给每一个属性起一个名称即属性名。

码：也成为码键。表中的某个属性组，它可以唯一确定一个元组；如表中的学号，可以唯一确定一个学生，也就称为本关系的码

域：属性的取值范围，如人的性别只有男和女两个等。

分量：元组中的一个属性值

关系模式：对关系的描述，一般表示为：关系名(属性1，属性2，$\cdots$，属性$n$)。如：学生关系：学生(学号，姓名，性别，班级，$\cdots$)

#### 关系数据模型的操作与完整性约束

关系数据模型的操作主要包括查询、插入、删除和更新数据这些操作必须满足关系的`完整性约束`条件。

关系的完整性约束条件包括三大类：

1. 实体完整性(必有一个或多个属性确定一个实体)；

2. 参照完整性(多个表同一属性必须相同)；

3. 用户定义完整性(如：规定教授的退休年龄$\ge65$，则此属性的属性值不能小于$65$)

#### 关系数据模型的优点

1. 关系模型与格式化模型不同，它是建立在严格的数学概念的基础上的
2. 关系模型的概念单一
3. 关系模型的存取路径对用户透明，从而具有更高的数据独立性，更好的安全保密性也简化了程序员的工作和数据库开发建立的工作。

## 4. 数据库系统结构

数据库系统模式概念：模式是数据库中全体数据的逻辑结构和特征的描述，同一个模式可以有很多实例。如：一篇论文格式规范，就是模式。

数据库结构分为三级模式和两级映射。

### 4.1 数据库的三级模式

数据库系统的三级模式结构是指数据库系统是由：外模式、模式和内模式的三级构成

[数据库三级模式结构图：](https://image.sybblogs.fun/img-common/202309121539102.png)

<img src="https://image.sybblogs.fun/img-common/202309121539102.png" alt="数据库三级模式结构图" style="zoom:43%;" />

1. 外模式(用户模式)：它是数据库用户能够看见使用的局部视图。直接对应程序接口。如：当用户查询信息的时候，展现在应用程序界面

2. 模式(逻辑模式)：是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图。是中间层。具体在数据库软件中存放方式

3. 内模式(存储模式)：一个数据库只有一个内模式。数据在物理硬盘中的存储方式

两级映像：

1. 内模式和模式之间有相互转换关系称为：`内模式/模式映像`。

2. 同样外模式和模式之间也有相互转换关系称为：`外模式/模式映像`。

注意：

（1）外模式通常是模式的子集，一个数据库可以有多个外模式。即用户通过视图看到数据只是数据库中的一部分。

（2）同一外模式也可以为某一用户的多个应用系统所使用，但一个应用程序只能使用一个外模式。即一个表可以给多个程序用，但一个应用程序只能用一个表。

（3）外模式是保证数据库安全的一个有力措施，每个用户只能看见和访问所对应的外模式中的数据。数据库中的其余数据不可见。

### 4.2 数据库的二级映像与数据独立性

数据库二级映像：内模式/模式映像、外模式/模式映像

当数据库的存储结构改变(例如选用了另一种存储结构)，由数据库管理员对模式$/$内模式映像作相应改变，可以使模式保持不变，从而应用程序也不必改变。保证了数据与程序的物理独立性，简称数据的物理独立性。

## 5. 数据库系统的组成

数据库系统一般由数据库、数据库管理系统(及其开发工具)、应用系统和数据库管理员构成。

数据库系统由于三方面构成：

（1）硬件平台及数据库

（2）数据库系统软件

（3）人员：数据库管理员、系统分析员和数据库设计人员、应用程序员和最终用户。

<img src="https://image.sybblogs.fun/img-common/202309121646942.png" alt="数据库系统人员构成" style="zoom:43%;" />

- 数据库管理员(DBA)

  DBA是这个机构的一个(组)人员，负责全面管理和控制数据库系统。具体职责包括：

  （1）决定数据库中的信息内容和结构，数据库中要存放哪些信息，DBA要参与决策

  （2）决定数据库的存储结构和存取策略

  （3）定义数据的安全性要求和完整性约束条件

  （4）监控数据库的使用和运行

  （5）数据库的改进和重组重构

- 系统分析员和数据库设计人员

  系统分析员负责应用系统的需求分析和规范说明，要和用户及DBA相结合，确定系统的硬件软件配置，并参与数据库系统的概要设计。

  数据库设计人员负责数据库中数据的确定、数据库各级模式的设计。

- 应用程序员

  应用程序员负责设计和编写应用系统的程序模块，并进行调试和安装。

- 用户

  这里用户是指最终用户。最终用户通过应用系统的用户接口使用数据库。

# 第二章 关系数据库

关系：是单一的数据结构，现实世界的实体以及实体间的各种联系均用关系来表示

逻辑结构：是二维表，从用户角度，关系模型中数据的逻辑结构是一张二维表。

关系模型是建立在集合代数的基础上。

## 1. 域

定义：域是一组具有**相同数据类型的值**的集合。例：整数、实数、介于某个取值范围的整数、指定长度的字符串集合、$\{男,女\}$等。

## 2. 笛卡尔积

定义：给定一组域$D_1,D_2,\cdots,D_n$，这些域可以是相同的。则$D_1,D_2,\cdots,D_n$的笛卡尔积为：

$D_1\times D_2\times\cdots\times D_n=\{(d_1,d_2,\cdots,d_n)|d_i\in D_i,i=1,2,\cdots n\}$[^2-2-1]。所有域的所有取值的一个组合。

例：$D_1=\{张清玫,刘逸\}$，$D_2=\{计算机专业,信息专业\}$，$D_3=\{李勇,刘晨,王敏\}$

则$D_1,D_2,D_3$的笛卡尔积为：$D_1\times D_2\times D_3=\{$(张清玫，计算机专业，李勇)，(张清玫，计算机专业，刘晨)，(张清玫，计算机专业，王敏)，(张清玫，信息专业，李勇)，(张清玫，信息专业，刘晨)，(张清玫，信息专业，王敏)，(刘逸，计算机专业，李勇)，(刘逸，计算机专业，刘晨)，(刘逸，计算机专业，王敏)，(刘逸，信息专业，李勇)，(刘逸，信息专业，刘晨)，(刘逸，信息专业，王敏) $\}$

笛卡尔积就是对所取域中值，进行一次排列组合。

